# Temporary pull in file
df <- read.csv("phenotype-genotype-file.tab", header=TRUE)
head(df)
# Libraries
library(tidyverse)
# Temporary pull in file
df <- read_tsv("phenotype-genotype-file.tab", header=TRUE)
df
rm(df)
# Temporary pull in file
df <- read_tsv("phenotype-genotype-file.tab")
df
unique(df$Trait)
names(df_
_
)
names(df)
df$Gene
df$`Gene ID`
df
preview(df)
display(df)
head(df)
print(tibble)
print(df)
print(df, n = 10)
View(df)
names(df)
tmp <- df[names(df) %>% svar]
tmp <- df[names(df) %in%svar]
# Important columns to be reorganized
svar <- c("Trait", "SNP rs", "Gene", "Gene 2", "Chromosome")
tmp <- df[names(df) %in%svar]
tmp <- df[names(df) %in% svar,]
tmp <- df[names(df) %in% svar]
tmp
unique(df$Trait)
# Important columns are selected
svar <- c("Trait", "SNP rs", "Gene", "Gene 2", "Chromosome")
df <- df[names(df) %in% svar]
df
b <- df[c("Trait", "SNP rs", "Gene 2", "Chromosome"),]
a <- df[names(df) %in% svar]
b
a
# Important columns are selected
svar <- c("Trait", "SNP rs", "Gene", "Chromosome")
a <- df[names(df) %in% svar]
b <- df[c("Trait", "SNP rs", "Gene 2", "Chromosome")]
b
names(b)
# Temporary pull in file
df <- read_tsv("phenotype-genotype-file.tab")
# Important columns are selected
svar <- c("Trait", "SNP rs", "Gene", "Chromosome")
a <- df[names(df) %in% svar]
b <- df[c("Trait", "SNP rs", "Gene 2", "Chromosome")]
names(b)[3] <- "Gene"
df <- bind_rows(a,b)
df
df <- bind_rows(a,b) %>% unique()
df
?gather
# Widen table to see all traits by gene
gather(df, key = gene, value = trait, -`SNP rs`, -Chromosome)
# Widen table to see all traits by gene
gather(df, key = gene, value = trait, -Chromosome)
# Widen table to see all traits by gene
gather(df, key = gene, value = trait)
df
# Widen table to see all traits by gene
gather(df, key = Gene, value = Trait)
# Widen table to see all traits by gene
gather(df, key = Gene, value = Trait, -"SNP rs", -"Chromosome")
# Widen table to see all traits by gene
gather(df, key = Gene, -"SNP rs", -"Chromosome")
# Widen table to see all traits by gene
gather(df, key = Gene, -`SNP rs`, -"Chromosome")
df
# Widen table to see all traits by gene
gather(df, Gene, Trait, -`SNP rs`, -Chromosome)
# Widen table to see all traits by gene
gather(df, key = "Gene", value = "Trait", -Chromosome)
df
# Widen table to see all traits by gene
gather(df[-2], key = "Gene", value = "Trait", -Chromosome)
# Widen table to see all traits by gene
gather(df[-2], key = "gene", value = "Trait", -Chromosome)
# Widen table to see all traits by gene
spread(df, key = "Gene", -`SNP rs`, -Chromosome)
df
# Widen table to see all traits by gene
spread(df, key = "Gene", -`SNP rs`)
# Widen table to see all traits by gene
spread(df, key = "tmp", -`SNP rs`, -Gene)
# Widen table to see all traits by gene
spread(df, key = "Trait", -`SNP rs`, -Gene)
df
# Widen table to see all traits by gene
tmp <- df[c("Gene", "Trait")]
tmp
spread(tmp, key = "Gene", -Gene)
# Temporary pull in file
df <- read_tsv("phenotype-genotype-file.tab")
df
# Important columns are selected and reorganized, stacking the Genes together
svar <- c("#", "Trait", "SNP rs", "Gene", "Chromosome")
a <- df[names(df) %in% svar]
names(b)[4] <- "Gene"
df <- bind_rows(a,b) %>% unique()
df
# Widen table to see all traits by gene
tmp <- df[c("#", "Gene", "Trait")]
spread(tmp, key = "Gene", -`#`)
# Widen table to see all traits by gene
tmp <- df[c("#", "Gene", "Trait")]
spread(tmp, key = "Gene")
tmp
spread(tmp, key = "Gene", value = "Trait")
spread(tmp, key = "Gene")
# Widen table to see all traits by gene
tmp <- df[c("#", "Gene", "Trait")]
tmp
spread(tmp, key = "#", -Gene)
spread(tmp, key = "#")
spread(tmp, key = `#`)
# Temporary pull in file
df <- read_tsv("phenotype-genotype-file.tab")
# Important columns are selected and reorganized, stacking the Genes together
svar <- c("Trait", "SNP rs", "Gene", "Chromosome")
a <- df[names(df) %in% svar]
b <- df[c("Trait", "SNP rs", "Gene 2", "Chromosome")]
names(b)[3] <- "Gene"
df <- bind_rows(a,b) %>% unique()
df
# Find duplicated genes
tmp <-
group_by(df, Gene) %>%
filter(n() > 1)
tmp
spread(tmp, key = "Gene", -`SNP rs`, -Chromosome)
# Find genes that are in multiple categories
tmp <-
group_by(df, Gene) %>%
filter(n() > 1)
spread(tmp, key = "Gene", -`SNP rs`, -Chromosome)
spread(tmp, key = "Gene", -`SNP rs`)
spread(tmp, key = "Trait", -`SNP rs`)
tmp
grep("Coronary", tmp$Trait)
grep("Coronary", tmp$Trait) %>% length
tmp
grep("Anxiety", tmp$Trait)
names(tmp)
unique(tmp$Trait)
df
tmp
filter(df, grepl("Coronary", Trait))
unique(df$Trait)
filter(df, grepl(paste(coronary, collapse="|"), Trait))
# Locate files that have duplicate types of genes in different categories
coronary <- c("Coronary", "Cardiac", "Heart")
filter(df, grepl(paste(coronary, collapse="|"), Trait))
# Group and filter approach
group_by(df, Gene) %>%
filter(Trait == "Coronary Disease")
# Group and filter approach
group_by(df, Gene) %>%
filter(Trait == "Coronary Disease" | Trait == "Coronary Artery Disease")
unique(df$Trait)
# Group and filter approach
group_by(df, Gene) %>%
filter((Trait == "Coronary Disease" | Trait == "Coronary Artery Disease" | Trait == "Acute Coronary Syndrome")) & Trait == "Depression")
# Group and filter approach
group_by(df, Gene) %>%
filter((Trait == "Coronary Disease" | Trait == "Coronary Artery Disease" | Trait == "Acute Coronary Syndrome") & Trait == "Depression")
# Group and filter approach
group_by(df, Gene) %>%
filter((Trait == "Coronary Disease" | Trait == "Coronary Artery Disease" | Trait == "Acute Coronary Syndrome") & Trait == "Anxiety")
# Group and filter approach
group_by(df, Gene) %>%
filter((Trait == "Coronary Disease" | Trait == "Coronary Artery Disease" | Trait == "Acute Coronary Syndrome") | Trait == "Anxiety")
# Group and filter approach
group_by(df, Gene) %>%
filter(Trait %in% c("Coronary Disease", "Acute Coronary Syndrome", "Coronary Artery Disease"))
spread(df, Trait, Gene)
df %>%
mutate(row = row_number()) %>%
spread(Trait, Gene, -Chromosome, -`SNP rs`)
df %>%
mutate(row = row_number()) %>%
spread(Trait, Gene)
df %>%
mutate(row = row_number()) %>%
spread(Trait)
df %>%
mutate(row = row_number()) %>%
spread(Gene, Trait)
df %>%
mutate(row = row_number()) %>%
spread(Trait, Gene)
df %>%
mutate(row = row_number()) %>%
spread(Trait, Gene) %>% print(n=40)
# Only genes that are represented in more than 1 phenotype
df %<>%
group_by(Gene) %>%
filter(n() > 1)
df
df %>% print(n=40)
# Simpify names of diseases
filter(df, grepl("Coronary", Trait))
unique(df$Gene)
df
dcast(df, Gene ~ Trait)
library(reshape2)
dcast(df, Gene ~ Trait)
dcast(df, Gene ~ Trait) %>% head
# Only genes that are represented in more than 1 phenotype
df[c("Trait", "Gene")] %<>%
group_by(Gene) %>%
filter(n() > 1)
# Temporary pull in file
df <- read_tsv("phenotype-genotype-file.tab")
# Important columns are selected and reorganized, stacking the Genes together
svar <- c("Trait", "SNP rs", "Gene", "Chromosome")
a <- df[names(df) %in% svar]
b <- df[c("Trait", "SNP rs", "Gene 2", "Chromosome")]
names(b)[3] <- "Gene"
df <- bind_rows(a,b) %>% unique()
# Only genes that are represented in more than 1 phenotype
df %<>%
group_by(Gene) %>%
filter(n() > 1)
#
dcast(df[c("Trait", "Gene")], Gene ~ Trait)
#
dcast(df[c("Trait", "Gene")], Gene ~ Trait) %>% head
# Widened the data, then finding only those with columns/traits of interest
dfw <- dcast(df[c("Trait", "Gene")], Gene ~ Trait)
rowSums(dfw)
# Widened the data, then finding only those with columns/traits of interest
dfw <- dcast(df[c("Trait", "Gene")], Gene ~ Trait) %>% as_tibble()
dfw
rowSums(dfw)
# Temporary pull in file
df <- read_tsv("phenotype-genotype-file.tab")
df
unique(df$Trait)
# Rename traits to consolidate them
df$Trait <- gsub("Coronary Disease", "coronary", df$Trait)
# Rename traits to consolidate them
df$Trait <- gsub("Coronary Disease", "Coronary", df$Trait)
df$Trait <- gsub("Coronary Artery Disease", "Coronary", df$Trait)
df$Trait <- gsub("Acute Coronary Syndrome", "Coronary", df$Trait)
unique(df$Trait)
tab")
# Rename traits to consolidate them
df$Trait <- gsub("Coronary Disease", "Coronary", df$Trait)
# Temporary pull in file
df <- read_tsv("phenotype-genotype-file.tab")
# Rename traits to consolidate them
df$Trait <- gsub("Coronary Disease", "Coronary", df$Trait)
df$Trait <- gsub("Coronary Artery Disease", "Coronary", df$Trait)
df$Trait <- gsub("Acute Coronary Syndrome", "Coronary", df$Trait)
unique(df$Trait)
# Temporary pull in file
df <- read_tsv("phenotype-genotype-file.tab")
# Rename coronary dz to consolidate them
df$Trait <- gsub("Coronary Disease", "Coronary", df$Trait)
df$Trait <- gsub("Coronary Artery Disease", "Coronary", df$Trait)
df$Trait <- gsub("Acute Coronary Syndrome", "Coronary", df$Trait)
df$Trait <- gsub("Coronary Vasospasm", "Coronary", df$Trait)
# Rename Arrhythmias
df$Trait <- gsub("Death, Sudden, Cardiac", "Arrhythmia", df$Trait)
df$Trait <- gsub("Arrhythmias, Cardiac", "Arrhythmia", df$Trait)
df$Trait <- gsub("Heart Failure", "Arrhythmia", df$Trait)
df$Trait <- gsub("Cardiac Conduction Defect", "Arrhythmia", df$Trait)
# Rename Depression
df$Trait <- gsub("Depressive Disorder", "Depression", df$Trait)
df$Trait <- gsub("Depressive Disorder, Major", "Depression", df$Trait)
df$Trait <- gsub("Depression", "Depression", df$Trait)
# Rename Stress and Anxiety
df$Trait <- gsub("Anxiety Disorders", "Stress", df$Trait)
df$Trait <- gsub("Stress, Psychological", "Stress", df$Trait)
df$Trait <- gsub("Stress Disorders, Post-Traumatic", "Stress", df$Trait)
df$Trait <- gsub("Anxiety", "Stress", df$Trait)
# Important columns are selected and reorganized, stacking the Genes together
svar <- c("Trait", "SNP rs", "Gene", "Chromosome")
a <- df[names(df) %in% svar]
b <- df[c("Trait", "SNP rs", "Gene 2", "Chromosome")]
names(b)[3] <- "Gene"
df <- bind_rows(a,b) %>% unique()
# Only genes that are represented in more than 1 phenotype
df %<>%
group_by(Gene) %>%
filter(n() > 1)
df
# Widened the data, then finding only those with columns/traits of interest
dfw <- dcast(df[c("Trait", "Gene")], Gene ~ Trait) %>% as_tibble()
dfw
source('~/Box Sync/projects/hrv/review/genefinder.R', echo=TRUE)
unique(dfw)
unique(dfw$Arrhythmia)
# Renumber all values to either 0 or 1
dfw[dfw %in% c(1:9)] <- 1
dfw
# Renumber all values to either 0 or 1
dfw[dfw == c(1:9)] <- 1
dfw
# Renumber all values to either 0 or 1
dfw[dfw == 3 ] <- 1
dfw
unique(dfw$Coronary)
# Renumber all values to either 0 or 1
dfw[dfw %in% c(1:23)] <- 1
dfw
# Widened the data, then finding only those with columns/traits of interest
dfw <- dcast(df[c("Trait", "Gene")], Gene ~ Trait) %>% as_tibble()
# Renumber all values to either 0 or 1
dfw[dfw %in% c(1:23)] <- 1
dfw
# Widened the data, then finding only those with columns/traits of interest
dfw <- dcast(df[c("Trait", "Gene")], Gene ~ Trait) %>% as_tibble()
dfw[-1] -> tmp
tmp[tmp != 0] <- 1
dfw[-1] <- tmp
dfw
# look for rows with multiple positive findings
rowSums(dfw[-1])
# look for rows with multiple positive findings
dfw$total <- rowSums(dfw[-1])
dfw
dfw[dfw$total > 1]
dfw[dfw$total > 1, ]
dfw <- dfw[dfw$Depression != 0 | dfw$Stress != 0, ]
dfw
dfw <- dfw[dfw$Arrhythmia != 0 | dfw$Coronary != 0, ]
dfw
df
# Final table with SNPs and Chromosome position
tbl <- right_join(dfw, df[-1], by = "Gene")
tbl
# Final table with SNPs and Chromosome position
tbl <- inner_join(dfw, df[-1], by = "Gene")
tbl
dfw
# Final table with SNPs and Chromosome position
tbl <- inner_join(dfw[-6], df[-1], by = "Gene")
tbl
# Final table with SNPs and Chromosome position
tbl <- inner_join(dfw[-6], df[-1], by = "Gene") %>% unique()
tbl
# Final table with SNPs and Chromosome position
tbl <- inner_join(dfw[-6], df[-1], by = "Gene") %>% unique() %>% filter(n() > 1)
tblr
tbl
# Final table with SNPs and Chromosome position
tbl <- inner_join(dfw[-6], df[-1], by = "Gene") %>% unique() %>% top_n(1)
tbl
# Final table with SNPs and Chromosome position
tbl <- inner_join(dfw[-6], df[-1], by = "Gene") %>% unique() %>% group_by(Gene) %>% top_n(1)
tbl
tbl %<>%
group_by(Gene) %>%
top_n(1, Gene)
tbl
# Final table with SNPs and Chromosome position
tbl <- inner_join(dfw[-6], df[-1], by = "Gene")
tbl %<>%
top_n(1, Gene)
tbl %>%
top_n(1, Gene)
# Final table with SNPs and Chromosome position
tbl <- inner_join(dfw[-6], df[-1], by = "Gene") %>% unique() %>% group_by(Gene) %>% slice(1)
tbl
write.csv(tbl, "overlapping_genes.csv", sep = ",", row.names = FALSE)
write.csv(tbl, "overlapping_genes.csv", row.names = FALSE)
ls
ls()
# Libraries
library(tidyverse)
library(reshape2)
# Temporary pull in file
df <- read_tsv("phenotype-genotype-file.tab")
df
# Rename coronary dz to consolidate them
df$Trait <- gsub("Coronary Disease", "Coronary", df$Trait)
df$Trait <- gsub("Coronary Artery Disease", "Coronary", df$Trait)
df$Trait <- gsub("Acute Coronary Syndrome", "Coronary", df$Trait)
df$Trait <- gsub("Coronary Vasospasm", "Coronary", df$Trait)
# Rename Arrhythmias
df$Trait <- gsub("Death, Sudden, Cardiac", "Arrhythmia", df$Trait)
df$Trait <- gsub("Arrhythmias, Cardiac", "Arrhythmia", df$Trait)
df$Trait <- gsub("Heart Failure", "Arrhythmia", df$Trait)
df$Trait <- gsub("Cardiac Conduction Defect", "Arrhythmia", df$Trait)
# Rename Depression
df$Trait <- gsub("Depressive Disorder", "Depression", df$Trait)
df$Trait <- gsub("Depressive Disorder, Major", "Depression", df$Trait)
df$Trait <- gsub("Depression, Major", "Depression", df$Trait)
df$Trait <- gsub("Depression", "Depression", df$Trait)
# Rename Stress and Anxiety
df$Trait <- gsub("Anxiety Disorders", "Stress", df$Trait)
df$Trait <- gsub("Stress, Psychological", "Stress", df$Trait)
df$Trait <- gsub("Stress Disorders, Post-Traumatic", "Stress", df$Trait)
df$Trait <- gsub("Anxiety", "Stress", df$Trait)
# Important columns are selected and reorganized, stacking the Genes together
svar <- c("Trait", "SNP rs", "Gene", "Chromosome")
a <- df[names(df) %in% svar]
b <- df[c("Trait", "SNP rs", "Gene 2", "Chromosome")]
names(b)[3] <- "Gene"
df <- bind_rows(a,b) %>% unique()
df
# Only genes that are represented in more than 1 phenotype
df %<>%
group_by(Gene) %>%
filter(n() > 1)
# Widened the data, then finding only those with columns/traits of interest
dfw <- dcast(df[c("Trait", "Gene")], Gene ~ Trait) %>% as_tibble()
dfw
